"use strict";(self.webpackChunkpier_doc=self.webpackChunkpier_doc||[]).push([[672],{3672:(t,o,e)=>{var i,s,n;n=function(t){function o(t,o,e,i){t.hasOwnProperty(o)||(t[o]=i.apply(null,e),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:o,module:t[o]}})))}o(t=t?t._modules:{},"Series/NodesComposition.js",[t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],(function(t,o){const{series:{prototype:e,prototype:{pointClass:{prototype:i}}}}=t,{defined:s,extend:n,find:r,merge:l,pick:a}=o;var h;return function(t){function h(){return this.data=[].concat(this.points||[],this.nodes),e.destroy.apply(this,arguments)}function d(){this.nodes&&(this.nodes.forEach((t=>{t.destroy()})),this.nodes.length=0),e.setData.apply(this,arguments)}function p(t){const o=arguments,e=this.isNode?this.linksTo.concat(this.linksFrom):[this.fromNode,this.toNode];"select"!==t&&e.forEach((t=>{t&&t.series&&(i.setState.apply(t,o),t.isNode||(t.fromNode.graphic&&i.setState.apply(t.fromNode,o),t.toNode&&t.toNode.graphic&&i.setState.apply(t.toNode,o)))})),i.setState.apply(this,o)}function c(t,o,e,s){const n=this.series.options.nodes,r=this.series.options.data,h=r&&r.length||0,d=r&&r[this.index];i.update.call(this,t,!this.isNode&&o,e,s),this.isNode&&(t=(n||[]).reduce(((t,o,e)=>this.id===o.id?e:t),-1),s=l(n&&n[t]||{},r&&r[this.index]||{}),r&&(d?r[this.index]=d:r.length=h),n?0<=t?n[t]=s:n.push(s):this.series.options.nodes=[s],a(o,!0)&&this.series.chart.redraw(e))}const u=[];t.compose=function(t,e){return o.pushUnique(u,t)&&((t=t.prototype).setNodeState=p,t.setState=p,t.update=c),o.pushUnique(u,e)&&((t=e.prototype).destroy=h,t.setData=d),e},t.createNode=function(t){const o=this.pointClass;var e=(t,o)=>r(t,(t=>t.id===o));let i=e(this.nodes,t);if(!i){e=this.options.nodes&&e(this.options.nodes,t);const s=(new o).init(this,n({className:"highcharts-node",isNode:!0,id:t,y:1},e));s.linksTo=[],s.linksFrom=[],s.getSum=function(){let t=0,o=0;return s.linksTo.forEach((o=>{t+=o.weight||0})),s.linksFrom.forEach((t=>{o+=t.weight||0})),Math.max(t,o)},s.offset=function(t,o){let e=0;for(let i=0;i<s[o].length;i++){if(s[o][i]===t)return e;e+=s[o][i].weight}},s.hasShape=function(){let t=0;return s.linksTo.forEach((o=>{o.outgoing&&t++})),!s.linksTo.length||t!==s.linksTo.length},s.index=this.nodes.push(s)-1,i=s}return i.formatPrefix="node",i.name=i.name||i.options.id||"",i.mass=a(i.options.mass,i.options.marker&&i.options.marker.radius,this.options.marker&&this.options.marker.radius,4),i},t.destroy=h,t.generatePoints=function(){const t=this.chart,o={};e.generatePoints.call(this),this.nodes||(this.nodes=[]),this.colorCounter=0,this.nodes.forEach((t=>{t.linksFrom.length=0,t.linksTo.length=0,t.level=t.options.level})),this.points.forEach((e=>{s(e.from)&&(o[e.from]||(o[e.from]=this.createNode(e.from)),o[e.from].linksFrom.push(e),e.fromNode=o[e.from],t.styledMode?e.colorIndex=a(e.options.colorIndex,o[e.from].colorIndex):e.color=e.options.color||o[e.from].color),s(e.to)&&(o[e.to]||(o[e.to]=this.createNode(e.to)),o[e.to].linksTo.push(e),e.toNode=o[e.to]),e.name=e.name||e.id}),this),this.nodeLookup=o},t.setNodeState=p,t.updateNode=c}(h||(h={})),h})),o(t,"Series/Sankey/SankeyPoint.js",[t["Core/Series/Point.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],(function(t,o,e){({seriesTypes:{column:o}}=o);const{defined:i}=e;class s extends o.prototype.pointClass{constructor(){super(...arguments),this.toNode=this.series=this.options=this.nodeY=this.nodeX=this.mass=this.linksTo=this.linksFrom=this.linkBase=this.level=this.fromNode=this.className=void 0}applyOptions(o,e){return t.prototype.applyOptions.call(this,o,e),i(this.options.level)&&(this.options.column=this.column=this.options.level),this}getClassName(){return(this.isNode?"highcharts-node ":"highcharts-link ")+t.prototype.getClassName.call(this)}getFromNode(){let t,o=-1;for(let e=0;e<this.linksTo.length;e++){const i=this.linksTo[e];i.fromNode.column>o&&i.fromNode!==this&&(t=i.fromNode,o=t.column)}return{fromNode:t,fromColumn:o}}setNodeColumn(){i(this.options.column)||(this.column=0===this.linksTo.length?0:this.getFromNode().fromColumn+1)}isValid(){return this.isNode||"number"==typeof this.weight}}return s})),o(t,"Series/Sankey/SankeySeriesDefaults.js",[],(function(){return{borderWidth:0,colorByPoint:!0,curveFactor:.33,dataLabels:{enabled:!0,backgroundColor:"none",crop:!1,nodeFormat:void 0,nodeFormatter:function(){return this.point.name},format:void 0,formatter:function(){},inside:!0},inactiveOtherPoints:!0,linkOpacity:.5,opacity:1,minLinkWidth:0,nodeWidth:20,nodePadding:10,showInLegend:!1,states:{hover:{linkOpacity:1,opacity:1},inactive:{linkOpacity:.1,opacity:.1,animation:{duration:50}}},tooltip:{followPointer:!0,headerFormat:'<span style="font-size: 0.8em">{series.name}</span><br/>',pointFormat:"{point.fromNode.name} \u2192 {point.toNode.name}: <b>{point.weight}</b><br/>",nodeFormat:"{point.name}: <b>{point.sum}</b><br/>"}}})),o(t,"Series/Sankey/SankeyColumnComposition.js",[t["Core/Utilities.js"]],(function(t){const{defined:o,relativeLength:e}=t;var i;return function(t){t.compose=function(t,o){return t.sankeyColumn=new i(t,o),t};class i{constructor(t,o){this.points=t,this.series=o}getTranslationFactor(t){const o=this.points,e=o.slice(),i=t.options.minLinkWidth||0;let s,n=0,r=(t.chart.plotSizeY||0)-(t.options.borderWidth||0)-(o.length-1)*t.nodePadding;for(;o.length;){for(n=r/o.sankeyColumn.sum(),t=!1,s=o.length;s--;)o[s].getSum()*n<i&&(o.splice(s,1),r-=i,t=!0);if(!t)break}return o.length=0,e.forEach((t=>{o.push(t)})),n}top(t){const o=this.series,e=o.nodePadding,i=this.points.reduce((function(i,s){return 0<i&&(i+=e),i+(s=Math.max(s.getSum()*t,o.options.minLinkWidth||0))}),0);return((o.chart.plotSizeY||0)-i)/2}left(t){const o=this.series,e=o.chart,i=o.options.equalNodes,s=e.inverted?e.plotHeight:e.plotWidth,n=o.nodePadding,r=this.points.reduce((function(e,r){return 0<e&&(e+=n),e+(r=i?s/r.series.nodes.length-n:Math.max(r.getSum()*t,o.options.minLinkWidth||0))}),0);return((e.plotSizeX||0)-Math.round(r))/2}sum(){return this.points.reduce((function(t,o){return t+o.getSum()}),0)}offset(t,i){const s=this.points,n=this.series,r=n.nodePadding;let l=0;if(n.is("organization")&&t.hangsFrom)return{absoluteTop:t.hangsFrom.nodeY};for(let h=0;h<s.length;h++){var a=s[h].getSum();const d=Math.max(a*i,n.options.minLinkWidth||0),p=t.options[n.chart.inverted?"offsetHorizontal":"offsetVertical"],c=t.options.offset||0;if(a=a?d+r:0,s[h]===t)return{relativeTop:l+(o(p)?e(p,d):e(c,a))};l+=a}}}t.SankeyColumnAdditions=i}(i||(i={})),i})),o(t,"Series/TreeUtilities.js",[t["Core/Color/Color.js"],t["Core/Utilities.js"]],(function(t,o){const{extend:e,isArray:i,isNumber:s,isObject:n,merge:r,pick:l}=o;return{getColor:function(o,e){const i=e.index;var s=e.mapOptionsToLevel;const n=e.parentColor,r=e.parentColorIndex,a=e.series;var h=e.colors;const d=e.siblings;var p=a.points,c=a.chart.options.chart;let u;var m;let f;if(o){if(p=p[o.i],o=s[o.level]||{},s=p&&o.colorByPoint){u=p.index%(h?h.length:c.colorCount);var g=h&&h[u]}a.chart.styledMode||(h=p&&p.options.color,c=o&&o.color,(m=n)&&(m=(m=o&&o.colorVariation)&&"brightness"===m.key&&i&&d?t.parse(n).brighten(i/d*m.to).get():n),m=l(h,c,g,m,a.color)),f=l(p&&p.options.colorIndex,o&&o.colorIndex,u,r,e.colorIndex)}return{color:m,colorIndex:f}},getLevelOptions:function(t){let o,e,a,h={};if(n(t)){a=s(t.from)?t.from:1;var d=t.levels;for(e={},o=n(t.defaults)?t.defaults:{},i(d)&&(e=d.reduce(((t,e)=>{let i,h;return n(e)&&s(e.level)&&(h=r({},e),i=l(h.levelIsConstant,o.levelIsConstant),delete h.levelIsConstant,delete h.level,e=e.level+(i?0:a-1),n(t[e])?r(!0,t[e],h):t[e]=h),t}),{})),d=s(t.to)?t.to:1,t=0;t<=d;t++)h[t]=r({},o,n(e[t])?e[t]:{})}return h},setTreeValues:function t(o,i){var s=i.before;const n=i.idRoot,r=i.mapIdToNode[n],a=i.points[o.i],h=a&&a.options||{},d=[];let p=0;return o.levelDynamic=o.level-(!1!==i.levelIsConstant?0:r.level),o.name=l(a&&a.name,""),o.visible=n===o.id||!0===i.visible,"function"==typeof s&&(o=s(o,i)),o.children.forEach(((s,n)=>{const r=e({},i);e(r,{index:n,siblings:o.children.length,visible:o.visible}),s=t(s,r),d.push(s),s.visible&&(p+=s.val)})),s=l(h.value,p),o.visible=0<=s&&(0<p||o.visible),o.children=d,o.childrenTotal=p,o.isLeaf=o.visible&&!p,o.val=s,o},updateRootId:function(t){if(n(t)){var o=n(t.options)?t.options:{};o=l(t.rootNode,o.rootId,""),n(t.userOptions)&&(t.userOptions.rootId=o),t.rootNode=o}return o}}})),o(t,"Series/Sankey/SankeySeries.js",[t["Core/Color/Color.js"],t["Core/Globals.js"],t["Series/NodesComposition.js"],t["Series/Sankey/SankeyPoint.js"],t["Series/Sankey/SankeySeriesDefaults.js"],t["Core/Series/SeriesRegistry.js"],t["Series/Sankey/SankeyColumnComposition.js"],t["Series/TreeUtilities.js"],t["Core/Utilities.js"]],(function(t,o,e,i,s,n,r,l,a){const{series:h,seriesTypes:{column:d}}=n,{getLevelOptions:p}=l,{clamp:c,extend:u,isObject:m,merge:f,pick:g,relativeLength:y,stableSort:v}=a;class k extends d{constructor(){super(...arguments),this.translationFactor=this.points=this.options=this.nodeWidth=this.nodes=this.nodePadding=this.nodeLookup=this.group=this.data=this.colDistance=void 0}static getDLOptions(t){const o=m(t.optionsPoint)?t.optionsPoint.dataLabels:{};return t=m(t.level)?t.level.dataLabels:{},f({style:{}},t,o)}createNodeColumns(){const t=[];this.nodes.forEach((function(o){o.setNodeColumn(),t[o.column]||(t[o.column]=r.compose([],this)),t[o.column].push(o)}),this);for(let o=0;o<t.length;o++)void 0===t[o]&&(t[o]=r.compose([],this));return t}order(t,o){const e=this;void 0===t.level&&(t.level=o,t.linksFrom.forEach((function(t){t.toNode&&e.order(t.toNode,o+1)})))}generatePoints(){e.generatePoints.apply(this,arguments);const t=this;this.orderNodes&&(this.nodes.filter((function(t){return 0===t.linksTo.length})).forEach((function(o){t.order(o,0)})),v(this.nodes,(function(t,o){return t.level-o.level})))}getNodePadding(){let t=this.options.nodePadding||0;if(this.nodeColumns){const o=this.nodeColumns.reduce(((t,o)=>Math.max(t,o.length)),0);o*t>this.chart.plotSizeY&&(t=this.chart.plotSizeY/o)}return t}hasData(){return!!this.processedXData.length}pointAttribs(o,e){if(!o)return{};const i=this,s=i.mapOptionsToLevel[(o.isNode?o.level:o.fromNode.level)||0]||{},n=o.options,r=s.states&&s.states[e||""]||{};e=["colorByPoint","borderColor","borderWidth","linkOpacity","opacity"].reduce((function(t,o){return t[o]=g(r[o],n[o],s[o],i.options[o]),t}),{});const l=g(r.color,n.color,e.colorByPoint?o.color:s.color);return o.isNode?{fill:l,stroke:e.borderColor,"stroke-width":e.borderWidth,opacity:e.opacity}:{fill:t.parse(l).setOpacity(e.linkOpacity).get()}}drawTracker(){d.prototype.drawTracker.call(this,this.points),d.prototype.drawTracker.call(this,this.nodes)}drawPoints(){d.prototype.drawPoints.call(this,this.points),d.prototype.drawPoints.call(this,this.nodes)}drawDataLabels(){d.prototype.drawDataLabels.call(this,this.points),d.prototype.drawDataLabels.call(this,this.nodes)}translate(){this.processedXData||this.processData(),this.generatePoints(),this.nodeColumns=this.createNodeColumns(),this.nodeWidth=y(this.options.nodeWidth,this.chart.plotSizeX);const t=this,o=this.chart,e=this.options,i=this.nodeWidth,s=this.nodeColumns;this.nodePadding=this.getNodePadding(),this.translationFactor=s.reduce(((o,e)=>Math.min(o,e.sankeyColumn.getTranslationFactor(t))),1/0),this.colDistance=(o.plotSizeX-i-e.borderWidth)/Math.max(1,s.length-1),t.mapOptionsToLevel=p({from:1,levels:e.levels,to:s.length-1,defaults:{borderColor:e.borderColor,borderRadius:e.borderRadius,borderWidth:e.borderWidth,color:t.color,colorByPoint:e.colorByPoint,levelIsConstant:!0,linkColor:e.linkColor,linkLineWidth:e.linkLineWidth,linkOpacity:e.linkOpacity,states:e.states}}),s.forEach((function(o){o.forEach((function(e){t.translateNode(e,o)}))}),this),this.nodes.forEach((function(o){o.linksFrom.forEach((function(o){(o.weight||o.isNull)&&o.to&&(t.translateLink(o),o.allowShadow=!1)}))}))}translateLink(t){var o=(o,e)=>(e=o.offset(t,e)*n,Math.min(o.nodeY+e,o.nodeY+(o.shapeArgs&&o.shapeArgs.height||0)-r));let e=t.fromNode;var i=t.toNode;let s=this.chart,n=this.translationFactor,r=Math.max(t.weight*n,this.options.minLinkWidth);var l=(s.inverted?-this.colDistance:this.colDistance)*this.options.curveFactor;let a=o(e,"linksFrom");o=o(i,"linksTo");let h=e.nodeX,d=this.nodeWidth;i=i.nodeX;var p=t.outgoing,c=i>h+d;if(s.inverted&&(a=s.plotSizeY-a,o=(s.plotSizeY||0)-o,d=-d,r=-r,c=h>i),t.shapeType="path",t.linkBase=[a,a+r,o,o+r],c&&"number"==typeof o)t.shapeArgs={d:[["M",h+d,a],["C",h+d+l,a,i-l,o,i,o],["L",i+(p?d:0),o+r/2],["L",i,o+r],["C",i-l,o+r,h+d+l,a+r,h+d,a+r],["Z"]]};else if("number"==typeof o){l=i-20-r,p=i-20;const e=(c=h+d)+20,n=e+r,u=a,m=a+r,f=m+20,g=f+(s.plotHeight-a-r),y=g+20,v=y+r,k=o,C=k+r,S=C+20,N=y+.7*r,b=i-.7*r,x=c+.7*r;t.shapeArgs={d:[["M",c,u],["C",x,u,n,m-.7*r,n,f],["L",n,g],["C",n,N,x,v,c,v],["L",i,v],["C",b,v,l,N,l,g],["L",l,S],["C",l,C-.7*r,b,k,i,k],["L",i,C],["C",p,C,p,C,p,S],["L",p,g],["C",p,y,p,y,i,y],["L",c,y],["C",e,y,e,y,e,g],["L",e,f],["C",e,m,e,m,c,m],["Z"]]}}t.dlBox={x:h+(i-h+d)/2,y:a+(o-a)/2,height:r,width:0},t.tooltipPos=s.inverted?[s.plotSizeY-t.dlBox.y-r/2,s.plotSizeX-t.dlBox.x]:[t.dlBox.x,t.dlBox.y+r/2],t.y=t.plotY=1,t.x=t.plotX=1,t.color||(t.color=e.color)}translateNode(t,o){var e=this.translationFactor;const i=this.chart,s=this.options,{borderRadius:n,borderWidth:r=0}=s;var l=t.getSum();const a=Math.max(Math.round(l*e),this.options.minLinkWidth),h=Math.round(this.nodeWidth);var d=Math.round(r)%2/2,p=o.sankeyColumn.offset(t,e);if(o=Math.floor(g(p.absoluteTop,o.sankeyColumn.top(e)+p.relativeTop))+d,d=Math.floor(this.colDistance*t.column+r/2)+y(t.options.offsetHorizontal||0,h)+d,d=i.inverted?i.plotSizeX-d:d,t.sum=l){t.shapeType="roundedRect",t.nodeX=d,t.nodeY=o,l=d,e=o,p=t.options.width||s.width||h;let r=t.options.height||s.height||a;const u=c(y("object"==typeof n?n.radius:n||0,p),0,a/2);i.inverted&&(l=d-h,e=i.plotSizeY-o-a,p=t.options.height||s.height||h,r=t.options.width||s.width||a),t.dlOptions=k.getDLOptions({level:this.mapOptionsToLevel[t.level],optionsPoint:t.options}),t.plotX=1,t.plotY=1,t.tooltipPos=i.inverted?[i.plotSizeY-e-r/2,i.plotSizeX-l-p/2]:[l+p/2,e+r/2],t.shapeArgs={x:l,y:e,width:p,height:r,r:u,display:t.hasShape()?"":"none"}}else t.dlOptions={enabled:!1}}}return k.defaultOptions=f(d.defaultOptions,s),e.compose(i,k),u(k.prototype,{animate:h.prototype.animate,createNode:e.createNode,forceDL:!0,invertible:!0,isCartesian:!1,orderNodes:!0,noSharedTooltip:!0,pointArrayMap:["from","to","weight"],pointClass:i,searchPoint:o.noop}),n.registerSeriesType("sankey",k),k})),o(t,"masters/modules/sankey.src.js",[],(function(){}))},t.exports?(n.default=n,t.exports=n):(i=[e(8840)],void 0===(s=function(t){return n(t),n.Highcharts=t,n}.apply(o,i))||(t.exports=s))}}]);